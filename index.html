<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Blackjack</title>
<style>
  body {
    font-family: "Segoe UI", sans-serif;
    margin: 0;
    background-color: #0a3d1c;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    transition: background 0.3s ease;
  }
  h1 { text-align: center; margin-top: 20px; }
  .game-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    width: 90%;
    max-width: 900px;
    gap: 20px;
  }
  .table {
    flex: 2;
    background: rgba(0,0,0,0.3);
    border: 2px solid #fff3;
    border-radius: 10px;
    padding: 20px;
    text-align: center;
  }
  .hand { margin: 10px 0; font-size: 1.5em; }
  .controls button {
    margin: 5px;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    background: #28a745;
    color: white;
    font-size: 1em;
    cursor: pointer;
    transition: background 0.2s ease;
  }
  .controls button:hover { background: #218838; }

  .panel {
    flex: 1;
    background: rgba(255,255,255,0.1);
    border-radius: 10px;
    padding: 10px;
    overflow-y: auto;
    max-height: 400px;
  }
  .panel h2 { font-size: 1.2em; text-align: center; }
  .history-entry {
    border-bottom: 1px solid rgba(255,255,255,0.2);
    padding: 4px 0;
    font-size: 0.9em;
  }
  .result {
    margin: 10px;
    font-weight: bold;
    font-size: 1.3em;
  }
  .customization label { display: block; margin-top: 5px; }
  .preset-colors button {
    margin: 3px;
    padding: 6px 10px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    color: white;
  }

  @media (max-width: 700px) {
    .game-container { flex-direction: column; align-items: center; }
    .panel { width: 100%; max-height: none; }
  }
</style>
</head>
<body>
  <h1>‚ô†Ô∏è Blackjack ‚ô£Ô∏è</h1>
  <div class="game-container">
    <div class="table">
      <div class="hand" id="dealer">Dealer: </div>
      <div class="hand" id="player">Player: </div>
      <div class="result" id="result"></div>
      <div class="controls">
        <button id="deal">Deal</button>
        <button id="hit">Hit</button>
        <button id="stand">Stand</button>
      </div>
    </div>

    <div class="panel" id="history-panel">
      <h2>üìú History</h2>
      <div id="history"></div>
      <div id="score-summary"></div>
    </div>

    <div class="panel customization">
      <h2>üé® Customization</h2>
      <label>Background color: <input type="color" id="bgColor" value="#0a3d1c"></label>
      <label>Accent color: <input type="color" id="accentColor" value="#28a745"></label>
      <label>UI Scale: <input type="range" id="scaleRange" min="0.8" max="1.4" step="0.1" value="1"></label>
      <div class="preset-colors">
        <p>Presets:</p>
        <button style="background:#1b1f3b" data-bg="#1b1f3b" data-accent="#00c3ff">Neon Blue</button>
        <button style="background:#3b0a0a" data-bg="#3b0a0a" data-accent="#ff4040">Casino Red</button>
        <button style="background:#093b1f" data-bg="#093b1f" data-accent="#00e676">Emerald Green</button>
        <button style="background:#3b2a09" data-bg="#3b2a09" data-accent="#ffd700">Golden Glow</button>
      </div>
    </div>
  </div>

<script>
const dealerEl = document.getElementById("dealer");
const playerEl = document.getElementById("player");
const resultEl = document.getElementById("result");
const historyEl = document.getElementById("history");
const scoreSummaryEl = document.getElementById("score-summary");

let deck = [], dealerHand = [], playerHand = [], wins = 0, losses = 0, ties = 0;

function createDeck() {
  const suits = ["‚ô†", "‚ô•", "‚ô¶", "‚ô£"];
  const values = ["A", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"];
  deck = [];
  for (let s of suits) {
    for (let v of values) deck.push({value: v, suit: s});
  }
  deck.sort(() => Math.random() - 0.5);
}

function getValue(hand) {
  let total = 0, aces = 0;
  for (let card of hand) {
    if (["J","Q","K"].includes(card.value)) total += 10;
    else if (card.value === "A") { total += 11; aces++; }
    else total += parseInt(card.value);
  }
  while (total > 21 && aces) { total -= 10; aces--; }
  return total;
}

function renderHands(hideDealer=false) {
  dealerEl.textContent = "Dealer: " + (hideDealer ? dealerHand[0].value + dealerHand[0].suit + " [hidden]" :
    dealerHand.map(c=>c.value+c.suit).join(" ")) + (hideDealer ? "" : " ("+getValue(dealerHand)+")");
  playerEl.textContent = "Player: " + playerHand.map(c=>c.value+c.suit).join(" ") + " ("+getValue(playerHand)+")";
}

function endGame(resultText) {
  resultEl.textContent = resultText;
  let playerTotal = getValue(playerHand), dealerTotal = getValue(dealerHand);
  if (resultText.includes("Win")) wins++;
  else if (resultText.includes("Lose")) losses++;
  else ties++;
  const entry = document.createElement("div");
  entry.className = "history-entry";
  entry.textContent = `Player ${playerTotal} vs Dealer ${dealerTotal} ‚Üí ${resultText}`;
  historyEl.appendChild(entry);
  scoreSummaryEl.textContent = `Wins: ${wins} | Losses: ${losses} | Ties: ${ties}`;
  historyEl.scrollTop = historyEl.scrollHeight;
}

document.getElementById("deal").onclick = () => {
  createDeck();
  playerHand = [deck.pop(), deck.pop()];
  dealerHand = [deck.pop(), deck.pop()];
  renderHands(true);
  resultEl.textContent = "";
};

document.getElementById("hit").onclick = () => {
  if (!playerHand.length) return;
  playerHand.push(deck.pop());
  renderHands(true);
  if (getValue(playerHand) > 21) {
    renderHands(false);
    endGame("You Lose (Bust)");
  }
};

document.getElementById("stand").onclick = () => {
  if (!playerHand.length) return;
  while (getValue(dealerHand) < 17) dealerHand.push(deck.pop());
  renderHands(false);
  const playerTotal = getValue(playerHand), dealerTotal = getValue(dealerHand);
  if (dealerTotal > 21 || playerTotal > dealerTotal) endGame("You Win!");
  else if (playerTotal < dealerTotal) endGame("You Lose!");
  else endGame("Tie!");
};

// Customization logic
const bgPicker = document.getElementById("bgColor");
const accentPicker = document.getElementById("accentColor");
const scaleRange = document.getElementById("scaleRange");
const presetBtns = document.querySelectorAll(".preset-colors button");

function applyTheme(bg, accent, scale) {
  document.body.style.background = bg;
  document.querySelectorAll(".controls button").forEach(btn => btn.style.background = accent);
  document.body.style.transform = `scale(${scale})`;
}

function saveSettings(bg, accent, scale) {
  localStorage.setItem("bj_settings", JSON.stringify({bg, accent, scale}));
}

function loadSettings() {
  const saved = localStorage.getItem("bj_settings");
  if (saved) {
    const {bg, accent, scale} = JSON.parse(saved);
    bgPicker.value = rgbToHex(bg);
    accentPicker.value = rgbToHex(accent);
    scaleRange.value = scale;
    applyTheme(bg, accent, scale);
  }
}

function rgbToHex(rgb) {
  const match = rgb.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/); // ‚úÖ fixed regex
  if (!match) return "#0a3d1c";
  return "#" + match.slice(1,4).map(x=>("0"+parseInt(x).toString(16)).slice(-2)).join("");
}

bgPicker.oninput = () => { applyTheme(bgPicker.value, accentPicker.value, scaleRange.value); saveSettings(bgPicker.value, accentPicker.value, scaleRange.value); };
accentPicker.oninput = () => { applyTheme(bgPicker.value, accentPicker.value, scaleRange.value); saveSettings(bgPicker.value, accentPicker.value, scaleRange.value); };
scaleRange.oninput = () => { applyTheme(bgPicker.value, accentPicker.value, scaleRange.value); saveSettings(bgPicker.value, accentPicker.value, scaleRange.value); };
presetBtns.forEach(btn => btn.onclick = () => {
  applyTheme(btn.dataset.bg, btn.dataset.accent, scaleRange.value);
  saveSettings(btn.dataset.bg, btn.dataset.accent, scaleRange.value);
});

loadSettings();
</script>
</body>
</html>
